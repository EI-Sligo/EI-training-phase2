<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T2 Knowledge Check</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@300;500;700&family=Roboto:wght@300;400;500;700&display=swap');

        :root {
            --safety-yellow: #FFD700;
            --industrial-grey: #1a202c;
            --card-bg: #2d3748;
            --success-green: #48bb78;
            --fail-red: #e53e3e;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--industrial-grey);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        h1, h2, h3, .brand-font { font-family: 'Oswald', sans-serif; text-transform: uppercase; }

        .hazard-stripe {
            background: repeating-linear-gradient(45deg, #000, #000 10px, #FFD700 10px, #FFD700 20px);
            height: 10px; width: 100%; position: fixed; top: 0; left: 0; z-index: 50;
        }

        .btn-opt {
            background-color: #4a5568;
            width: 100%;
            padding: 1rem;
            text-align: left;
            border-radius: 0.5rem;
            transition: all 0.2s;
            border: 2px solid transparent;
            margin-bottom: 0.75rem;
        }

        .btn-opt:hover { background-color: #718096; border-color: var(--safety-yellow); }
        
        .btn-opt.correct { background-color: var(--success-green); color: white; }
        .btn-opt.wrong { background-color: var(--fail-red); color: white; }

        .btn-nav {
            background-color: var(--safety-yellow); color: black; font-weight: bold;
            padding: 0.75rem 2rem; border-radius: 0.25rem; font-family: 'Oswald', sans-serif;
            transition: background 0.2s;
        }
        .btn-nav:hover { background-color: #e6c200; }

        .progress-bar {
            height: 6px; background: var(--safety-yellow); width: 0%; transition: width 0.3s;
        }
    </style>
</head>
<body>

    <div class="hazard-stripe"></div>

    <div id="start-screen" class="flex-grow flex flex-col justify-center items-center text-center p-8">
        <h1 class="text-6xl font-bold mb-6 text-white">T2 Knowledge Check</h1>
        <div class="bg-gray-800 p-8 rounded border border-gray-600 max-w-2xl">
            <h3 class="text-2xl text-yellow-400 mb-4">Assessment Details</h3>
            <ul class="text-left text-gray-300 space-y-3 mb-8">
                <li><i class="fas fa-book mr-2"></i> <strong>Scope:</strong> All 9 Installation Techniques Units.</li>
                <li><i class="fas fa-random mr-2"></i> <strong>Format:</strong> 20 Randomly Selected Questions.</li>
                <li><i class="fas fa-check-circle mr-2"></i> <strong>Pass Mark:</strong> 85% (17/20 Correct).</li>
                <li><i class="fas fa-database mr-2"></i> <strong>Bank Size:</strong> 280+ Questions.</li>
            </ul>
            <button onclick="startQuiz()" class="btn-nav text-xl">Begin Assessment</button>
        </div>
    </div>

    <div id="quiz-screen" class="hidden flex-col flex-grow max-w-4xl mx-auto w-full pt-12 px-4">
        <div class="flex justify-between items-center mb-6">
            <span class="text-gray-400 text-sm">Question <span id="q-current">1</span> of 20</span>
            <span class="text-yellow-400 font-bold text-sm" id="topic-badge">TOPIC</span>
        </div>

        <div class="w-full bg-gray-700 h-2 rounded-full mb-8 overflow-hidden">
            <div id="progress" class="progress-bar"></div>
        </div>

        <div class="bg-gray-800 p-8 rounded border border-gray-600 shadow-lg">
            <h2 id="question-text" class="text-2xl font-bold mb-8 leading-relaxed">Question goes here?</h2>
            <div id="options-container"></div>
        </div>

        <div class="mt-8 text-center">
            <button id="next-btn" onclick="nextQuestion()" class="btn-nav hidden">Next Question <i class="fas fa-arrow-right ml-2"></i></button>
        </div>
    </div>

    <div id="result-screen" class="hidden flex-grow flex flex-col justify-center items-center text-center p-8">
        <div id="score-card" class="bg-gray-800 p-10 rounded border border-gray-600 max-w-2xl w-full">
            <h1 class="text-5xl font-bold mb-2 text-white">Assessment Complete</h1>
            
            <div class="my-8">
                <div class="text-8xl font-bold mb-2" id="final-score">0%</div>
                <div class="text-2xl uppercase tracking-widest" id="pass-fail-text">RESULT</div>
            </div>

            <div class="grid grid-cols-2 gap-4 text-left bg-gray-900 p-4 rounded mb-8">
                <div><i class="fas fa-check text-green-500 mr-2"></i> Correct: <span id="count-correct">0</span></div>
                <div><i class="fas fa-times text-red-500 mr-2"></i> Incorrect: <span id="count-wrong">0</span></div>
            </div>

            <div class="flex gap-4 justify-center">
                <button onclick="location.reload()" class="px-6 py-3 bg-gray-600 hover:bg-gray-500 rounded font-bold">Retry <i class="fas fa-redo ml-2"></i></button>
                <button onclick="saveAndExit()" class="btn-nav">Save & Exit <i class="fas fa-save ml-2"></i></button>
            </div>
        </div>
    </div>

    <script>
        const questionBank = [
            // BATCH 1
            { q: "A micrometer is used to measure:", options: ["Length", "CSA", "Inner Diameter", "Outer Diameter"], a: 3, topic: "Basic Engineering" },
            { q: "Which tool marks a hole centre?", options: ["Scriber", "Centre Punch", "Dividers", "Chisel"], a: 1, topic: "Basic Engineering" },
            { q: "Correct drill bit angle?", options: ["90 deg", "118 deg", "60 deg", "180 deg"], a: 1, topic: "Basic Engineering" },
            { q: "Hacksaw teeth should point:", options: ["Towards handle", "Away from handle", "Alternating", "Anywhere"], a: 1, topic: "Basic Engineering" },
            { q: "Fluid for threading steel?", options: ["Water", "Trefolex", "Oil", "Dry"], a: 1, topic: "Basic Engineering" },
            { q: "Part of drill that cuts?", options: ["Flute", "Web", "Lips", "Shank"], a: 2, topic: "Basic Engineering" },
            { q: "Steel rule accuracy?", options: ["0.01mm", "0.5mm", "1.0mm", "0.02mm"], a: 1, topic: "Basic Engineering" },
            { q: "Blade TPI for thin metal?", options: ["14", "18", "24", "32"], a: 3, topic: "Basic Engineering" },
            { q: "Pilot hole purpose?", options: ["Tap thread", "Guide large drill", "Countersink", "Measure"], a: 1, topic: "Basic Engineering" },
            { q: "File for rapid removal?", options: ["Single Cut", "Double Cut", "Rasp", "Smooth"], a: 1, topic: "Basic Engineering" },
            
            // BATCH 2
            { q: "Conduit space factor?", options: ["35%", "40%", "45%", "50%"], a: 1, topic: "Conduit & Trunking" },
            { q: "Joining trunking requires:", options: ["Running coupler", "Copper strap", "Glue", "Wire"], a: 1, topic: "Conduit & Trunking" },
            { q: "PVC Expansion coupler spacing?", options: ["3m", "4m", "6m", "10m"], a: 2, topic: "Conduit & Trunking" },
            { q: "Outdoor conduit type?", options: ["Black Enamel", "Galvanised", "Light PVC", "Oval"], a: 1, topic: "Conduit & Trunking" },
            { q: "1.5mm cables in 2m of 20mm conduit?", options: ["10", "12", "14", "16"], a: 2, topic: "Conduit & Trunking" },
            { q: "Reason to limit cables in conduit?", options: ["Easy install", "Keep close", "Prevent heat", "Cost"], a: 2, topic: "Conduit & Trunking" },
            { q: "Min radius 20mm steel conduit?", options: ["20mm", "50mm", "80mm", "100mm"], a: 1, topic: "Conduit & Trunking" },
            { q: "Max temp for PVC conduit?", options: ["45C", "50C", "60C", "70C"], a: 2, topic: "Conduit & Trunking" },
            { q: "Max trunking space factor?", options: ["35%", "45%", "50%", "60%"], a: 1, topic: "Conduit & Trunking" },
            { q: "Reason for grouping AC conductors?", options: ["Space", "Eddy Currents", "Resistance", "Volt Drop"], a: 1, topic: "Conduit & Trunking" },

            // BATCH 3
            { q: "Copper vs Aluminium advantage?", options: ["Weight", "Cost", "Conductivity", "Resistance"], a: 2, topic: "Cables & Termination" },
            { q: "Insulation for high temp?", options: ["PVC", "Rubber", "Mineral Insulated", "Polythene"], a: 2, topic: "Cables & Termination" },
            { q: "Double length means resistance:", options: ["Halves", "Same", "Doubles", "Quadruples"], a: 2, topic: "Cables & Termination" },
            { q: "Factor NOT affecting current capacity?", options: ["Temp", "Installation", "Grouping", "Voltage Rating"], a: 3, topic: "Cables & Termination" },
            { q: "Cable Sheath purpose?", options: ["Insulation", "Mech Protection", "Earth", "Transformation"], a: 1, topic: "Cables & Termination" },
            { q: "Not a conductor?", options: ["Copper", "Aluminium", "PVC", "Silver"], a: 2, topic: "Cables & Termination" },
            { q: "Resistance increases if:", options: ["Length down", "CSA up", "Length up", "Volts up"], a: 2, topic: "Cables & Termination" },
            { q: "Phase colour (Single Phase)?", options: ["Blue", "Brown", "Red", "Black"], a: 1, topic: "Cables & Termination" },
            { q: "Reduce volt drop by:", options: ["More length", "More CSA", "Less CSA", "More insulation"], a: 1, topic: "Cables & Termination" },
            { q: "Min flex size for pendant?", options: ["0.5", "0.75", "1.0", "1.5"], a: 1, topic: "Cables & Termination" },

            // BATCH 4
            { q: "Taper tap use?", options: ["Finish hole", "Start thread", "Deepen", "Remove screw"], a: 1, topic: "Basic Engineering" },
            { q: "Drill web is:", options: ["Outer edge", "Cutting lip", "Central column", "Shank"], a: 2, topic: "Basic Engineering" },
            { q: "File for smooth finish?", options: ["Bastard", "Second", "Smooth", "Rasp"], a: 2, topic: "Basic Engineering" },
            { q: "Internal thread tool?", options: ["Die", "Tap", "Reamer", "Countersink"], a: 1, topic: "Basic Engineering" },
            { q: "External thread tool?", options: ["Die", "Tap", "Reamer", "Drill"], a: 0, topic: "Basic Engineering" },
            { q: "Plug tap feature?", options: ["Tapered", "No taper", "Hex shank", "Left thread"], a: 1, topic: "Basic Engineering" },
            { q: "Drilling large hole first step?", options: ["Hammer", "Pilot hole", "High speed", "No lube"], a: 1, topic: "Basic Engineering" },
            { q: "Align holes tool?", options: ["Centre punch", "Prick punch", "Drift punch", "Pin punch"], a: 2, topic: "Basic Engineering" },
            { q: "Centre punch angle?", options: ["30", "60", "90", "120"], a: 2, topic: "Basic Engineering" },
            { q: "20mm hole in thin sheet?", options: ["Twist drill", "Hole saw", "Reamer", "Chisel"], a: 1, topic: "Basic Engineering" },
            { q: "Cross-filing purpose?", options: ["Remove fast", "Polish", "Check flat", "Draw file"], a: 0, topic: "Basic Engineering" },
            { q: "Washer for vibration?", options: ["Flat", "Spring", "Fibre", "Penny"], a: 1, topic: "Basic Engineering" },
            { q: "Pozi-drive feature?", options: ["Slip", "Reduce cam-out", "Slotted", "Hammer"], a: 1, topic: "Basic Engineering" },
            { q: "Lube for Aluminium?", options: ["Trefolex", "Paraffin", "Dry", "Water"], a: 1, topic: "Basic Engineering" },
            { q: "Vernier 12.0 + 0.45?", options: ["12.45", "12.045", "1.245", "124.5"], a: 0, topic: "Basic Engineering" },
            { q: "Blind rivet name?", options: ["Pop rivet", "Solid", "Screw", "Bolt"], a: 0, topic: "Basic Engineering" },
            { q: "Hex nut measurement?", options: ["A/F", "A/C", "Pitch", "Depth"], a: 1, topic: "Basic Engineering" },
            { q: "Rawlbolt used in?", options: ["Plaster", "Concrete", "Wood", "Plastic"], a: 1, topic: "Basic Engineering" },
            { q: "Toggle bolt used in?", options: ["Solid wall", "Hollow wall", "Steel", "Floor"], a: 1, topic: "Basic Engineering" },
            { q: "Hacksaw pressure stroke?", options: ["Back", "Forward", "Both", "Side"], a: 1, topic: "Basic Engineering" },
            { q: "Saddle holding off wall?", options: ["Spacer Bar", "Distance", "Half", "Hospital"], a: 1, topic: "Conduit & Trunking" },
            { q: "Bend 20mm PVC tool?", options: ["Machine", "Internal spring", "External spring", "Heat"], a: 1, topic: "Conduit & Trunking" },
            { q: "Setback meaning?", options: ["Length", "Gain loss", "Spring back", "Distance to wall"], a: 1, topic: "Conduit & Trunking" },
            { q: "Max support 20mm PVC?", options: ["0.5m", "1.0m", "1.2m", "1.5m"], a: 2, topic: "Conduit & Trunking" },
            { q: "Terminating gland use?", options: ["Expansion", "Connect to box", "Water exit", "Hang cable"], a: 1, topic: "Conduit & Trunking" },
            { q: "Trunking capacity factor?", options: ["Length", "Size (CSA)", "Colour", "Make"], a: 1, topic: "Conduit & Trunking" },
            { q: "Fitting for sharp 90?", options: ["Inspection Elbow", "Inspection Bend", "Coupler", "Saddle"], a: 0, topic: "Conduit & Trunking" },
            { q: "Galvanised coating?", options: ["Paint", "Zinc", "Copper", "Plastic"], a: 1, topic: "Conduit & Trunking" },
            { q: "Black enamel use?", options: ["Outside", "Underground", "Indoor Dry", "Chemical"], a: 2, topic: "Conduit & Trunking" },
            { q: "Prevent condensation?", options: ["Insulation", "Drainage", "Heating", "Larger cable"], a: 1, topic: "Conduit & Trunking" },
            { q: "Steel conduit thread?", options: ["Metric Coarse", "Metric Fine", "BSP", "NPT"], a: 1, topic: "Conduit & Trunking" },
            { q: "Female bush use?", options: ["Join", "Protect cable", "Connect coupler", "Support"], a: 2, topic: "Conduit & Trunking" },
            { q: "Seal PVC joints?", options: ["Heat", "Solvent Cement", "Tape", "Thread seal"], a: 1, topic: "Conduit & Trunking" },
            { q: "Through box entries?", options: ["One", "Opposite", "Adjacent", "Four"], a: 1, topic: "Conduit & Trunking" },
            { q: "PVC Trunking disadvantage?", options: ["Cost", "Weight", "Expansion", "Conductivity"], a: 2, topic: "Conduit & Trunking" },
            { q: "Steel trunking earth?", options: ["Lid", "Copper strap", "Screws", "Wall"], a: 1, topic: "Conduit & Trunking" },
            { q: "Flexible conduit IP?", options: ["Material", "Gland type", "Length", "Cable"], a: 1, topic: "Conduit & Trunking" },
            { q: "Thread cutting tool?", options: ["Tap", "Stocks & Dies", "Reamer", "Cutter"], a: 1, topic: "Conduit & Trunking" },
            { q: "2.5mm in 50x50 trunking?", options: ["10", "20", "33", "40"], a: 2, topic: "Conduit & Trunking" },
            { q: "Trunking 45 cut?", options: ["Lid", "Side walls", "Base", "Sides/Lid"], a: 1, topic: "Conduit & Trunking" },
            { q: "CPC stands for?", options: ["Central Phase", "Circuit Protective", "Copper Plated", "Common Power"], a: 1, topic: "Cables & Termination" },
            { q: "Stranded vs Solid?", options: ["Voltage", "Flexibility", "Cost", "Diameter"], a: 1, topic: "Cables & Termination" },
            { q: "XLPE max temp?", options: ["70", "90", "105", "150"], a: 1, topic: "Cables & Termination" },
            { q: "2.5mm crimp colour?", options: ["Red", "Blue", "Yellow", "Green"], a: 1, topic: "Cables & Termination" },
            { q: "6.0mm crimp colour?", options: ["Red", "Blue", "Yellow", "Black"], a: 2, topic: "Cables & Termination" },
            { q: "Bootlace ferrule use?", options: ["Solid", "Fine strand", "Armoured", "Coaxial"], a: 1, topic: "Cables & Termination" },
            { q: "Flux purpose?", options: ["Cool", "Clean oxides", "Resist", "Insulate"], a: 1, topic: "Cables & Termination" },
            { q: "Cold solder look?", options: ["Shiny", "Dull/Grainy", "Transparent", "Liquid"], a: 1, topic: "Cables & Termination" },
            { q: "Pendant cable?", options: ["T&E", "Heat Flex", "Armoured", "Singles"], a: 1, topic: "Cables & Termination" },
            { q: "Current capacity reduced by?", options: ["Grouping", "Low temp", "Short length", "Air"], a: 0, topic: "Cables & Termination" },
            { q: "Lighting cable CSA?", options: ["1.5", "2.5", "4.0", "6.0"], a: 0, topic: "Cables & Termination" },
            { q: "Socket cable CSA?", options: ["1.5", "2.5", "4.0", "10.0"], a: 1, topic: "Cables & Termination" },
            { q: "Factor Ca?", options: ["Ambient Temp", "Grouping", "Insulation", "Volt Drop"], a: 0, topic: "Cables & Termination" },
            { q: "Factor Cg?", options: ["Ambient Temp", "Grouping", "Insulation", "Fuse"], a: 1, topic: "Cables & Termination" },
            { q: "Plug polarity Brown?", options: ["Left", "Top", "Right (Fuse)", "Grip"], a: 2, topic: "Cables & Termination" },
            { q: "Figure 8 cable?", options: ["Mains", "Audio", "Data", "Earth"], a: 1, topic: "Cables & Termination" },
            { q: "NYM-J use?", options: ["Underground", "Surface", "High Temp", "Flex"], a: 1, topic: "Cables & Termination" },
            { q: "Best conductor?", options: ["Gold", "Silver", "Copper", "Aluminium"], a: 1, topic: "Cables & Termination" },
            { q: "Creep disadvantage?", options: ["Copper", "Aluminium", "Steel", "Brass"], a: 1, topic: "Cables & Termination" },
            { q: "Insulation Res unit?", options: ["Ohms", "Milli", "Mega", "Kilo"], a: 2, topic: "Cables & Termination" },
            { q: "1-Way terminals?", options: ["L1, L2, L3", "C, L1", "C, L1, L2", "L, N"], a: 1, topic: "Lighting" },
            { q: "2-Way terminals?", options: ["C, L1", "C, L1, L2", "L1-L4", "L, N, E"], a: 1, topic: "Lighting" },
            { q: "Intermediate terminals?", options: ["2", "3", "4", "6"], a: 2, topic: "Lighting" },
            { q: "Halogen gas?", options: ["Neon", "Argon", "Iodine/Bromine", "Oxygen"], a: 2, topic: "Lighting" },
            { q: "Longest lamp life?", options: ["Incandescent", "Halogen", "CFL", "LED"], a: 3, topic: "Lighting" },
            { q: "Light colour unit?", options: ["Lumens", "Lux", "Kelvin", "Watts"], a: 2, topic: "Lighting" },
            { q: "Luminous efficacy unit?", options: ["Watts", "Lumens/Watt", "Candela", "Lux"], a: 1, topic: "Lighting" },
            { q: "PIR detects?", options: ["Sound", "Infrared", "Light", "Smoke"], a: 1, topic: "Lighting" },
            { q: "Loop-In location?", options: ["Switch", "Ceiling Rose", "Junction Box", "Fuse Board"], a: 1, topic: "Lighting" },
            { q: "Starter wiring?", options: ["Series Heater", "Parallel Supply", "Series Choke", "Parallel Tube"], a: 0, topic: "Lighting" },
            { q: "HF fitting lacks?", options: ["Tube", "Starter", "Housing", "Supply"], a: 1, topic: "Lighting" },
            { q: "LV downlighter voltage?", options: ["6V", "12V", "24V", "48V"], a: 1, topic: "Lighting" },
            { q: "Halogen transformer?", options: ["230AC-12DC", "230AC-12AC", "12DC-230AC", "AC-DC"], a: 1, topic: "Lighting" },
            { q: "Touch halogen glass?", options: ["Shock", "Nothing", "Oil/Failure", "Explode"], a: 2, topic: "Lighting" },
            { q: "Cable saving switch?", options: ["2-Way", "Intermediate", "Impulse Relay", "Master"], a: 2, topic: "Lighting" },
            { q: "Switch height?", options: ["450", "900-1200", "1500", "2000"], a: 1, topic: "Lighting" },
            { q: "Emergency light duration?", options: ["1h", "3h", "5h", "24h"], a: 1, topic: "Lighting" },
            { q: "Non-maintained meaning?", options: ["Always on", "Off until fail", "Day only", "Portable"], a: 1, topic: "Lighting" },
            { q: "Bathroom Zone 1 IP?", options: ["IP20", "IP44", "IP65", "IPX4"], a: 3, topic: "Lighting" },
            { q: "Photocell control?", options: ["Movement", "Time", "Daylight", "Sound"], a: 2, topic: "Lighting" },
            { q: "Type B MCB colour?", options: ["Green", "Red", "Black", "Yellow"], a: 0, topic: "Protective Devices" },
            { q: "Fuse factor?", options: ["1.1", "1.45", "2.0", "1.0"], a: 1, topic: "Protective Devices" },
            { q: "HRC meaning?", options: ["High Res", "High Rupturing", "Heat Res", "Heavy Rating"], a: 1, topic: "Protective Devices" },
            { q: "Fire protection device?", options: ["Fuse", "MCB", "RCD 300mA", "Isolator"], a: 2, topic: "Protective Devices" },
            { q: "RCD Test button?", options: ["Earth path", "Loop Imp", "Mechanism", "Calibration"], a: 2, topic: "Protective Devices" },
            { q: "Icn rating?", options: ["Normal", "Short-circuit cap", "Trip curve", "Voltage"], a: 1, topic: "Protective Devices" },
            { q: "D-Type fuse safety?", options: ["Colour", "Gauge ring", "Length", "Thread"], a: 1, topic: "Protective Devices" },
            { q: "Neozed vs Diazed?", options: ["Larger", "Compact", "DC only", "Rewirable"], a: 1, topic: "Protective Devices" },
            { q: "Selectivity means?", options: ["Same rating", "Lower upstream", "Higher upstream", "No fuses"], a: 2, topic: "Protective Devices" },
            { q: "Disconnects P&N?", options: ["SP MCB", "DP Switch", "Fuse", "SP Switch"], a: 1, topic: "Protective Devices" },
            { q: "IP2X?", options: ["Water", "Dust", "Fingers", "Wire"], a: 2, topic: "Protective Devices" },
            { q: "IP4X?", options: ["Fingers", "Wire >1mm", "Dust", "Water"], a: 1, topic: "Protective Devices" },
            { q: "IP65?", options: ["Dust/Jet", "Dust/Splash", "None", "Submersible"], a: 0, topic: "Protective Devices" },
            { q: "TT main protection?", options: ["Fuse", "MCB", "RCD", "Earth Rod"], a: 2, topic: "Protective Devices" },
            { q: "SPD protects?", options: ["Overload", "Short", "Spikes", "UnderV"], a: 2, topic: "Protective Devices" },
            { q: "Main DB SPD type?", options: ["1", "2", "3", "4"], a: 1, topic: "Protective Devices" },
            { q: "AFDD detects?", options: ["Earth", "Overcurrent", "Arc Faults", "Phase"], a: 2, topic: "Protective Devices" },
            { q: "Motor protection?", options: ["Overload/Phase Loss", "Speed", "Vib", "Dust"], a: 0, topic: "Protective Devices" },
            { q: "Lock-off kit use?", options: ["Tools", "LOTO", "Doors", "Ties"], a: 1, topic: "Protective Devices" },
            { q: "High inrush MCB?", options: ["B", "C", "D", "K"], a: 2, topic: "Protective Devices" },
            { q: "Storage heater supply?", options: ["Ring", "Off-peak", "Lighting", "Plug"], a: 1, topic: "Fixed Appliances" },
            { q: "Dual stat rod expands to?", options: ["Make", "Break", "Lock", "Short"], a: 1, topic: "Fixed Appliances" },
            { q: "Immersion safety cut-out?", options: ["Auto", "Manual", "Non", "Remote"], a: 1, topic: "Fixed Appliances" },
            { q: "Water heater switch?", options: ["10A", "20A DP Neon", "45A", "5A"], a: 1, topic: "Fixed Appliances" },
            { q: "Under-sink type?", options: ["Vented", "Unvented", "Instant", "Gas"], a: 1, topic: "Fixed Appliances" },
            { q: "IPX4 bathroom?", options: ["None", "Drip", "Splash", "Jet"], a: 2, topic: "Fixed Appliances" },
            { q: "Shaver socket content?", options: ["Capacitor", "Iso Transformer", "Battery", "Rectifier"], a: 1, topic: "Fixed Appliances" },
            { q: "Zone 2 Towel Rail?", options: ["12V", "Hard wired IPX4", "Plug", "Battery"], a: 1, topic: "Fixed Appliances" },
            { q: "Cooker diversity?", options: ["10%", "30%", "50%", "100%"], a: 1, topic: "Fixed Appliances" },
            { q: "Cooker socket add?", options: ["0A", "5A", "13A", "30A"], a: 1, topic: "Fixed Appliances" },
            { q: "CO alarm location?", options: ["Floor", "Near fuel", "Bathroom", "Attic"], a: 1, topic: "Fixed Appliances" },
            { q: "Smoke alarm interconnect?", options: ["Bluetooth", "3-core", "WiFi", "Fibre"], a: 1, topic: "Fixed Appliances" },
            { q: "Cooker switch height?", options: ["Low", "Worktop", "Not above hob", "Ceiling"], a: 2, topic: "Fixed Appliances" },
            { q: "Instant shower heat?", options: ["Store", "Pass over element", "Gas", "Solar"], a: 1, topic: "Fixed Appliances" },
            { q: "Shower RCD?", options: ["100mA", "30mA", "300mA", "500mA"], a: 1, topic: "Fixed Appliances" },
            { q: "Fan heater effect?", options: ["Magnetic", "Chemical", "Heating", "Electro"], a: 2, topic: "Fixed Appliances" },
            { q: "Fixed appliance ex?", options: ["Kettle", "Toaster", "Hand dryer", "Lamp"], a: 2, topic: "Fixed Appliances" },
            { q: "Storage heater conn?", options: ["Flex outlet", "Plug", "Twist", "Block"], a: 0, topic: "Fixed Appliances" },
            { q: "13A plug max cable?", options: ["1.5", "2.5", "4.0", "0.5"], a: 0, topic: "Fixed Appliances" },
            { q: "Zone 0?", options: ["Sink", "Inside bath", "Above bath", "0.6m"], a: 1, topic: "Fixed Appliances" },
            { q: "TN-S earth?", options: ["Rod", "Sheath", "Neutral", "None"], a: 1, topic: "Earthing & Bonding" },
            { q: "PEN?", options: ["Prot Earth Neut", "Phase Earth Neut", "Pos Earth Neg", "Pri Earth Node"], a: 0, topic: "Earthing & Bonding" },
            { q: "TN-C-S broken N?", options: ["Lights", "Metalwork Live", "RCD", "Fuse"], a: 1, topic: "Earthing & Bonding" },
            { q: "Earth rod res factor?", options: ["Soil", "Air", "Wind", "Time"], a: 0, topic: "Earthing & Bonding" },
            { q: "Bonding reduces?", options: ["Current", "Touch Voltage", "Res", "Power"], a: 1, topic: "Earthing & Bonding" },
            { q: "Gas bond dist?", options: ["600mm", "1m", "2m", "Any"], a: 0, topic: "Earthing & Bonding" },
            { q: "Supp bonding room?", options: ["Living", "Bed", "Bath", "Hall"], a: 2, topic: "Earthing & Bonding" },
            { q: "Earth rod measure?", options: ["Loop", "3-spike", "Insulation", "Volt"], a: 1, topic: "Earthing & Bonding" },
            { q: "PME label?", options: ["Private", "Prot Multiple Earth", "Primary", "Phase"], a: 1, topic: "Earthing & Bonding" },
            { q: "Earthing cond min?", options: ["6", "10", "16", "25"], a: 1, topic: "Earthing & Bonding" },
            { q: "High Loop Imp?", options: ["Fuse fast", "Fuse slow/fail", "Dim", "Power up"], a: 1, topic: "Earthing & Bonding" },
            { q: "Step potential?", options: ["Hand-foot", "Hands", "Feet", "P-N"], a: 2, topic: "Earthing & Bonding" },
            { q: "Touch volt max?", options: ["12", "50", "110", "230"], a: 1, topic: "Earthing & Bonding" },
            { q: "Rod material?", options: ["Alum", "Copper clad", "Plastic", "Iron"], a: 1, topic: "Earthing & Bonding" },
            { q: "Ze measures?", options: ["Total", "External", "Internal", "Bonding"], a: 1, topic: "Earthing & Bonding" },
            { q: "Zs measures?", options: ["Ze", "R1+R2", "Total", "Ins"], a: 2, topic: "Earthing & Bonding" },
            { q: "Earthing cond connects?", options: ["Water", "MET/Rod", "Case", "Socket"], a: 1, topic: "Earthing & Bonding" },
            { q: "Prot cond must be?", options: ["Switched", "Fused", "Continuous", "Resistive"], a: 2, topic: "Earthing & Bonding" },
            { q: "Exposed conductive?", options: ["Live", "Metal equip", "Plastic", "Water"], a: 1, topic: "Earthing & Bonding" },
            { q: "Extraneous conductive?", options: ["Elec case", "Metal pipe", "Cable", "Switch"], a: 1, topic: "Earthing & Bonding" },
            { q: "Bedding SWA?", options: ["Outside", "Under armour", "Copper", "Gland"], a: 1, topic: "Multicore Cables" },
            { q: "XLPE?", options: ["Extra", "Cross Linked", "Xenon", "None"], a: 1, topic: "Multicore Cables" },
            { q: "XLPE temp?", options: ["70", "90", "105", "60"], a: 1, topic: "Multicore Cables" },
            { q: "LSF?", options: ["Sulphur", "Low Smoke Fume", "Long Steel", "Speed"], a: 1, topic: "Multicore Cables" },
            { q: "LSF use?", options: ["Domestic", "Public", "Under", "Ext"], a: 1, topic: "Multicore Cables" },
            { q: "CY SY?", options: ["Armoured", "Flex Control", "HV", "Data"], a: 1, topic: "Multicore Cables" },
            { q: "SY braid?", options: ["Water", "Mech/Screen", "Ins", "Heat"], a: 1, topic: "Multicore Cables" },
            { q: "Pot term?", options: ["PVC", "SWA", "MICC", "Data"], a: 2, topic: "Multicore Cables" },
            { q: "MgO use?", options: ["SWA", "MICC", "PVC", "FP200"], a: 1, topic: "Multicore Cables" },
            { q: "Hygroscopic?", options: ["Repel", "Absorb", "Waterproof", "Magnetic"], a: 1, topic: "Multicore Cables" },
            { q: "Fire cable ins?", options: ["Paper", "Silicone", "PVC", "Cotton"], a: 1, topic: "Multicore Cables" },
            { q: "Cat 5?", options: ["Power", "Twisted Pair", "Armour", "Lead"], a: 1, topic: "Multicore Cables" },
            { q: "Data length?", options: ["50", "90-100", "200", "500"], a: 1, topic: "Multicore Cables" },
            { q: "Fibre optic?", options: ["Electrons", "Light", "Radio", "Sound"], a: 1, topic: "Multicore Cables" },
            { q: "Fibre bend?", options: ["Tight", "Critical", "Unimportant", "Same"], a: 1, topic: "Multicore Cables" },
            { q: "Cleat support?", options: ["Loose", "Secure", "Armour", "Ends"], a: 1, topic: "Multicore Cables" },
            { q: "EMI affects?", options: ["Power", "Data", "Earth", "Steel"], a: 1, topic: "Multicore Cables" },
            { q: "Screened cable?", options: ["Heat", "EMI", "Current", "Look"], a: 1, topic: "Multicore Cables" },
            { q: "Tray link?", options: ["Strength", "Earth", "Look", "Hold"], a: 1, topic: "Multicore Cables" },
            { q: "Cut ladder?", options: ["Rung", "Side", "Any", "Cable"], a: 1, topic: "Multicore Cables" },
            { q: "Safe Isolation 1st?", options: ["Test", "Identify", "Lock", "Gloves"], a: 1, topic: "Installation Testing" },
            { q: "Proving unit?", options: ["Test circ", "Verify tester", "Calibrate", "Cont"], a: 1, topic: "Installation Testing" },
            { q: "R1+R2?", options: ["P+N", "P+E", "N+E", "Total"], a: 1, topic: "Installation Testing" },
            { q: "Test R1+R2 link?", options: ["P-N", "P-E", "N-E", "All"], a: 1, topic: "Installation Testing" },
            { q: "Zs calc?", options: ["0.2", "0.15", "0.8", "1.5"], a: 2, topic: "Installation Testing" },
            { q: "IR unit?", options: ["Ohm", "Meg", "Milli", "Kilo"], a: 1, topic: "Installation Testing" },
            { q: "Low IR cause?", options: ["New", "Damp", "Tight", "Short"], a: 1, topic: "Installation Testing" },
            { q: "Null removes?", options: ["Batt", "Leads", "Circ", "Earth"], a: 1, topic: "Installation Testing" },
            { q: "Polarity check?", options: ["IR", "Cont", "Earth", "RCD"], a: 1, topic: "Installation Testing" },
            { q: "Socket Polarity?", options: ["LL NN EE", "LN NL", "LE", "Rand"], a: 0, topic: "Installation Testing" },
            { q: "Live test?", options: ["Cont", "IR", "Pol", "Loop"], a: 3, topic: "Installation Testing" },
            { q: "RCD angles?", options: ["90", "180", "270", "360"], a: 1, topic: "Installation Testing" },
            { q: "Func test?", options: ["Screw", "Switch", "Length", "Weight"], a: 1, topic: "Installation Testing" },
            { q: "Periodic for?", options: ["New", "Existing", "Portable", "Machine"], a: 1, topic: "Installation Testing" },
            { q: "Site freq?", options: ["1y", "3y", "3m", "1w"], a: 2, topic: "Installation Testing" },
            { q: "Rental freq?", options: ["1y", "5y", "10y", "Never"], a: 1, topic: "Installation Testing" },
            { q: "Cert sign?", options: ["Home", "QC", "App", "Supp"], a: 1, topic: "Installation Testing" },
            { q: "IP4X probe?", options: ["Finger", "1mm", "2.5mm", "Water"], a: 1, topic: "Installation Testing" },
            { q: "IP2X probe?", options: ["Finger", "1mm", "Sphere", "Hammer"], a: 0, topic: "Installation Testing" },
            { q: "Volt drop check?", options: ["Calc", "Guess", "Fuse", "Feel"], a: 0, topic: "Installation Testing" }
        ];

        // =================================================================
        //  ENGINE
        // =================================================================
        
        let currentQuestions = [];
        let currentIndex = 0;
        let score = 0;

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startQuiz() {
            const shuffled = shuffleArray([...questionBank]);
            currentQuestions = shuffled.slice(0, 20);
            currentIndex = 0;
            score = 0;
            
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('quiz-screen').classList.add('flex');
            
            renderQuestion();
        }

        function renderQuestion() {
            const q = currentQuestions[currentIndex];
            document.getElementById('q-current').innerText = currentIndex + 1;
            document.getElementById('topic-badge').innerText = q.topic;
            document.getElementById('question-text').innerText = q.q;
            document.getElementById('progress').style.width = `${((currentIndex) / 20) * 100}%`;
            
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            document.getElementById('next-btn').classList.add('hidden');

            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'btn-opt text-lg text-white';
                btn.innerText = opt;
                btn.onclick = () => selectAnswer(btn, index, q.a);
                container.appendChild(btn);
            });
        }

        function selectAnswer(btn, index, correctIndex) {
            const buttons = document.querySelectorAll('.btn-opt');
            buttons.forEach(b => b.disabled = true);

            if (index === correctIndex) {
                btn.classList.add('correct');
                btn.innerHTML += ' <i class="fas fa-check float-right"></i>';
                score++;
            } else {
                btn.classList.add('wrong');
                btn.innerHTML += ' <i class="fas fa-times float-right"></i>';
                buttons[correctIndex].classList.add('correct');
                buttons[correctIndex].innerHTML += ' <i class="fas fa-check float-right"></i>';
            }

            document.getElementById('next-btn').classList.remove('hidden');
            if(currentIndex === 19) {
                document.getElementById('next-btn').innerText = "Finish Assessment";
            }
        }

        function nextQuestion() {
            currentIndex++;
            if(currentIndex < 20) {
                renderQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('flex');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('result-screen').classList.add('flex');

            const percentage = (score / 20) * 100;
            const passed = percentage >= 85;

            document.getElementById('final-score').innerText = `${percentage}%`;
            document.getElementById('count-correct').innerText = score;
            document.getElementById('count-wrong').innerText = 20 - score;

            const resultText = document.getElementById('pass-fail-text');
            const scoreCard = document.getElementById('score-card');

            if(passed) {
                resultText.innerText = "PASSED";
                resultText.className = "text-2xl uppercase tracking-widest text-green-500 font-bold";
                scoreCard.style.borderColor = "#48bb78";
            } else {
                resultText.innerText = "FAILED (Req 85%)";
                resultText.className = "text-2xl uppercase tracking-widest text-red-500 font-bold";
                scoreCard.style.borderColor = "#e53e3e";
            }
        }

        function saveAndExit() {
            const percentage = (score / 20) * 100;
            if(percentage >= 85) {
                localStorage.setItem('kc_t2', 'completed');
            }
            window.location.href = '../Knowledge_Hub.html';
        }
    </script>
</body>
</html>